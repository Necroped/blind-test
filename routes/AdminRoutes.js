const
    express = require('express'),
    router  = express.Router(),
    admin   = require("../controllers/AdminController.js"),
    team    = require("../controllers/TeamController.js");

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////// GET //////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

router.get('/', isAuthenticated, admin.home);

router.get('/players', isAuthenticated, admin.players);

router.get('/teams', isAuthenticated, admin.teams);

router.get('/register', isAuthenticated, admin.register);

router.get('/logout', isAuthenticated, admin.logout);

router.get('/login', admin.login);

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////// POST //////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

router.post('/register', isAuthenticated, admin.doRegister);

router.post('/team/create', isAuthenticated, team.create);

router.post('/login', admin.doLogin);


//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////// AUTH //////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

function isAuthenticated(req, res, next) {
    if (req.user) {
        return next();
    }
    res.redirect('/admin/login');
}

module.exports = router;